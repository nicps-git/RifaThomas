<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Teste - A√ß√µes R√°pidas Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        
        .test-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        .danger-btn {
            background-color: #dc3545 !important;
        }
        
        .danger-btn:hover {
            background-color: #c82333 !important;
        }
        
        .success-btn {
            background-color: #28a745 !important;
        }
        
        .success-btn:hover {
            background-color: #218838 !important;
        }
        
        .log {
            background-color: #212529;
            color: #ffffff;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .function-info {
            background: linear-gradient(45deg, #17a2b8, #138496);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Teste das A√ß√µes R√°pidas do Admin</h1>
        <p>Este teste verifica se as fun√ß√µes <code>resetAllNumbers()</code>, <code>exportParticipants()</code> e <code>performDraw()</code> foram implementadas corretamente.</p>
        
        <div id="connectionStatus" class="status info">
            üîÑ Verificando fun√ß√µes...
        </div>
    </div>

    <div class="container">
        <h2>üìä Status das Fun√ß√µes</h2>
        
        <div class="test-section">
            <h3>üóëÔ∏è resetAllNumbers()</h3>
            <div id="resetStatus" class="status info">Verificando...</div>
            <p><strong>Fun√ß√£o:</strong> Apaga todos os dados de participantes permanentemente</p>
            <p><strong>Seguran√ßa:</strong> Dupla confirma√ß√£o obrigat√≥ria</p>
            <button onclick="testResetFunction()" class="danger-btn">‚ö†Ô∏è Testar Fun√ß√£o Reset</button>
        </div>
        
        <div class="test-section">
            <h3>üì• exportParticipants()</h3>
            <div id="exportStatus" class="status info">Verificando...</div>
            <p><strong>Fun√ß√£o:</strong> Exporta lista de participantes em CSV</p>
            <p><strong>Formato:</strong> Nome, telefone, n√∫meros, pagamento, status</p>
            <button onclick="testExportFunction()" class="success-btn">üì• Testar Exporta√ß√£o</button>
        </div>
        
        <div class="test-section">
            <h3>üé≤ performDraw()</h3>
            <div id="drawStatus" class="status info">Verificando...</div>
            <p><strong>Fun√ß√£o:</strong> Realiza sorteio dos pr√™mios automaticamente</p>
            <p><strong>Crit√©rio:</strong> Apenas n√∫meros confirmados participam</p>
            <button onclick="testDrawFunction()">üé≤ Testar Sorteio</button>
        </div>
        
        <div class="test-section">
            <h3>üóëÔ∏è deleteParticipant()</h3>
            <div id="deleteStatus" class="status info">Verificando...</div>
            <p><strong>Fun√ß√£o:</strong> Remove participante espec√≠fico</p>
            <p><strong>Uso:</strong> Chamada automaticamente pelos bot√µes de a√ß√£o</p>
            <button onclick="testDeleteFunction()">üß™ Testar Exclus√£o</button>
        </div>
    </div>

    <div class="container">
        <h2>üîó Links de Teste</h2>
        <div style="text-align: center;">
            <button onclick="openAdmin()">üîß Abrir Painel Admin</button>
            <button onclick="openMainPage()">üè† P√°gina Principal</button>
            <button onclick="createTestData()">üß™ Criar Dados de Teste</button>
        </div>
        
        <div class="function-info">
            <h3>üí° Como Usar as Fun√ß√µes:</h3>
            <ul>
                <li><strong>Reset:</strong> Use com EXTREMA cautela - apaga TODOS os dados</li>
                <li><strong>Export:</strong> Gera arquivo CSV com lista completa de participantes</li>
                <li><strong>Sorteio:</strong> Seleciona vencedores automaticamente entre n√∫meros confirmados</li>
                <li><strong>Delete:</strong> Remove participante individual (usado pelos bot√µes de a√ß√£o)</li>
            </ul>
        </div>
    </div>

    <div class="container">
        <h2>üìã Log de Teste</h2>
        <div id="logArea" class="log">
            === TESTE DAS FUN√á√ïES INICIADO ===
        </div>
        <button onclick="clearLog()">üóëÔ∏è Limpar Log</button>
    </div>

    <script src="firebase-config.js"></script>
    <script src="admin.js"></script>
    <script>
        function log(message, level = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const levelIcon = {
                'info': '‚ÑπÔ∏è',
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è'
            }[level] || '‚ÑπÔ∏è';
            
            logArea.innerHTML += `\n[${timestamp}] ${levelIcon} ${message}`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }
        
        function checkFunction(functionName) {
            if (typeof window[functionName] === 'function') {
                log(`‚úÖ Fun√ß√£o ${functionName} encontrada e dispon√≠vel`, 'success');
                return true;
            } else {
                log(`‚ùå Fun√ß√£o ${functionName} N√ÉO encontrada`, 'error');
                return false;
            }
        }
        
        function testResetFunction() {
            log('üß™ Testando fun√ß√£o resetAllNumbers...');
            
            if (checkFunction('resetAllNumbers')) {
                updateStatus('resetStatus', '‚úÖ Fun√ß√£o resetAllNumbers dispon√≠vel', 'success');
                
                const testReset = confirm('‚ö†Ô∏è ATEN√á√ÉO: Deseja realmente testar a fun√ß√£o de reset?\n\nIsso pode apagar dados reais se houver algum!\n\nRecomendo testar apenas com dados de teste.');
                
                if (testReset) {
                    log('üö® Usu√°rio confirmou teste de reset', 'warning');
                    try {
                        window.resetAllNumbers();
                        log('‚úÖ Fun√ß√£o resetAllNumbers executada', 'success');
                    } catch (error) {
                        log(`‚ùå Erro ao executar resetAllNumbers: ${error.message}`, 'error');
                    }
                } else {
                    log('‚ÑπÔ∏è Teste de reset cancelado pelo usu√°rio', 'info');
                }
            } else {
                updateStatus('resetStatus', '‚ùå Fun√ß√£o resetAllNumbers N√ÉO encontrada', 'error');
            }
        }
        
        function testExportFunction() {
            log('üß™ Testando fun√ß√£o exportParticipants...');
            
            if (checkFunction('exportParticipants')) {
                updateStatus('exportStatus', '‚úÖ Fun√ß√£o exportParticipants dispon√≠vel', 'success');
                
                try {
                    window.exportParticipants();
                    log('‚úÖ Fun√ß√£o exportParticipants executada', 'success');
                } catch (error) {
                    log(`‚ùå Erro ao executar exportParticipants: ${error.message}`, 'error');
                }
            } else {
                updateStatus('exportStatus', '‚ùå Fun√ß√£o exportParticipants N√ÉO encontrada', 'error');
            }
        }
        
        function testDrawFunction() {
            log('üß™ Testando fun√ß√£o performDraw...');
            
            if (checkFunction('performDraw')) {
                updateStatus('drawStatus', '‚úÖ Fun√ß√£o performDraw dispon√≠vel', 'success');
                
                const testDraw = confirm('üé≤ Deseja testar a fun√ß√£o de sorteio?\n\nSe houver dados reais, um sorteio real ser√° realizado!');
                
                if (testDraw) {
                    log('üé≤ Usu√°rio confirmou teste de sorteio', 'info');
                    try {
                        window.performDraw();
                        log('‚úÖ Fun√ß√£o performDraw executada', 'success');
                    } catch (error) {
                        log(`‚ùå Erro ao executar performDraw: ${error.message}`, 'error');
                    }
                } else {
                    log('‚ÑπÔ∏è Teste de sorteio cancelado pelo usu√°rio', 'info');
                }
            } else {
                updateStatus('drawStatus', '‚ùå Fun√ß√£o performDraw N√ÉO encontrada', 'error');
            }
        }
        
        function testDeleteFunction() {
            log('üß™ Testando fun√ß√£o deleteParticipant...');
            
            if (checkFunction('deleteParticipant')) {
                updateStatus('deleteStatus', '‚úÖ Fun√ß√£o deleteParticipant dispon√≠vel', 'success');
                log('‚ÑπÔ∏è Fun√ß√£o deleteParticipant encontrada (usada pelos bot√µes de a√ß√£o)', 'info');
            } else {
                updateStatus('deleteStatus', '‚ùå Fun√ß√£o deleteParticipant N√ÉO encontrada', 'error');
            }
        }
        
        function createTestData() {
            log('üß™ Tentando criar dados de teste...');
            
            if (checkFunction('createSampleData')) {
                try {
                    window.createSampleData();
                    log('‚úÖ Dados de teste criados', 'success');
                } catch (error) {
                    log(`‚ùå Erro ao criar dados de teste: ${error.message}`, 'error');
                }
            } else {
                log('‚ö†Ô∏è Fun√ß√£o createSampleData n√£o encontrada', 'warning');
            }
        }
        
        function openAdmin() {
            window.open('admin.html', '_blank');
            log('üîß Painel admin aberto', 'info');
        }
        
        function openMainPage() {
            window.open('index.html', '_blank');
            log('üè† P√°gina principal aberta', 'info');
        }
        
        function clearLog() {
            document.getElementById('logArea').innerHTML = '=== LOG LIMPO ===';
        }
        
        // Verifica√ß√£o inicial
        function init() {
            log('üîß Iniciando verifica√ß√£o das fun√ß√µes de a√ß√µes r√°pidas...');
            
            // Verificar todas as fun√ß√µes
            const functions = ['resetAllNumbers', 'exportParticipants', 'performDraw', 'deleteParticipant'];
            let allFound = true;
            
            functions.forEach(funcName => {
                if (!checkFunction(funcName)) {
                    allFound = false;
                }
            });
            
            if (allFound) {
                updateStatus('connectionStatus', '‚úÖ Todas as fun√ß√µes est√£o dispon√≠veis!', 'success');
                log('üéâ Todas as fun√ß√µes de a√ß√µes r√°pidas est√£o implementadas', 'success');
            } else {
                updateStatus('connectionStatus', '‚ö†Ô∏è Algumas fun√ß√µes est√£o faltando', 'warning');
                log('‚ö†Ô∏è Nem todas as fun√ß√µes est√£o dispon√≠veis', 'warning');
            }
            
            // Verificar status individual
            setTimeout(() => {
                testResetFunction();
                testExportFunction();
                testDrawFunction();
                testDeleteFunction();
            }, 1000);
        }
        
        // Iniciar quando carregar
        window.addEventListener('load', () => {
            setTimeout(init, 500);
        });
    </script>
</body>
</html>
