<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”§ Teste - AÃ§Ãµes RÃ¡pidas Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .status {
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        .warning { background-color: #fff3cd; color: #856404; }
        
        .test-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        .danger-btn {
            background-color: #dc3545 !important;
        }
        
        .danger-btn:hover {
            background-color: #c82333 !important;
        }
        
        .success-btn {
            background-color: #28a745 !important;
        }
        
        .success-btn:hover {
            background-color: #218838 !important;
        }
        
        .log {
            background-color: #212529;
            color: #ffffff;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
        
        .function-info {
            background: linear-gradient(45deg, #17a2b8, #138496);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ Teste das AÃ§Ãµes RÃ¡pidas do Admin</h1>
        <p>Este teste verifica se as funÃ§Ãµes <code>resetAllNumbers()</code>, <code>exportParticipants()</code> e <code>performDraw()</code> foram implementadas corretamente.</p>
        
        <div id="connectionStatus" class="status info">
            ğŸ”„ Verificando funÃ§Ãµes...
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“Š Status das FunÃ§Ãµes</h2>
        
        <div class="test-section">
            <h3>ğŸ—‘ï¸ resetAllNumbers()</h3>
            <div id="resetStatus" class="status info">Verificando...</div>
            <p><strong>FunÃ§Ã£o:</strong> Apaga todos os dados de participantes permanentemente</p>
            <p><strong>SeguranÃ§a:</strong> Dupla confirmaÃ§Ã£o obrigatÃ³ria</p>
            <button onclick="testResetFunction()" class="danger-btn">âš ï¸ Testar FunÃ§Ã£o Reset</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ“¥ exportParticipants()</h3>
            <div id="exportStatus" class="status info">Verificando...</div>
            <p><strong>FunÃ§Ã£o:</strong> Exporta lista de participantes em CSV</p>
            <p><strong>Formato:</strong> Nome, telefone, nÃºmeros, pagamento, status</p>
            <button onclick="testExportFunction()" class="success-btn">ğŸ“¥ Testar ExportaÃ§Ã£o</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ² performDraw()</h3>
            <div id="drawStatus" class="status info">Verificando...</div>
            <p><strong>FunÃ§Ã£o:</strong> Realiza sorteio dos prÃªmios automaticamente</p>
            <p><strong>CritÃ©rio:</strong> Apenas nÃºmeros confirmados participam</p>
            <button onclick="testDrawFunction()">ğŸ² Testar Sorteio</button>
        </div>
        
        <div class="test-section">
            <h3>ğŸ—‘ï¸ deleteParticipant()</h3>
            <div id="deleteStatus" class="status info">Verificando...</div>
            <p><strong>FunÃ§Ã£o:</strong> Remove participante especÃ­fico</p>
            <p><strong>Uso:</strong> Chamada automaticamente pelos botÃµes de aÃ§Ã£o</p>
            <button onclick="testDeleteFunction()">ğŸ§ª Testar ExclusÃ£o</button>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ”— Links de Teste</h2>
        <div style="text-align: center;">
            <button onclick="openAdmin()">ğŸ”§ Abrir Painel Admin</button>
            <button onclick="openMainPage()">ğŸ  PÃ¡gina Principal</button>
            <button onclick="createTestData()">ğŸ§ª Criar Dados de Teste</button>
        </div>
        
        <div class="function-info">
            <h3>ğŸ’¡ Como Usar as FunÃ§Ãµes:</h3>
            <ul>
                <li><strong>Reset:</strong> Use com EXTREMA cautela - apaga TODOS os dados</li>
                <li><strong>Export:</strong> Gera arquivo CSV com lista completa de participantes</li>
                <li><strong>Sorteio:</strong> Seleciona vencedores automaticamente entre nÃºmeros confirmados</li>
                <li><strong>Delete:</strong> Remove participante individual (usado pelos botÃµes de aÃ§Ã£o)</li>
            </ul>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“‹ Log de Teste</h2>
        <div id="logArea" class="log">
            === TESTE DAS FUNÃ‡Ã•ES INICIADO ===
        </div>
        <button onclick="clearLog()">ğŸ—‘ï¸ Limpar Log</button>
    </div>

    <script src="firebase-config.js"></script>
    <script src="admin.js"></script>
    <script>
        function log(message, level = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const levelIcon = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸'
            }[level] || 'â„¹ï¸';
            
            logArea.innerHTML += `\n[${timestamp}] ${levelIcon} ${message}`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = `status ${type}`;
        }
        
        function checkFunction(functionName) {
            if (typeof window[functionName] === 'function') {
                log(`âœ… FunÃ§Ã£o ${functionName} encontrada e disponÃ­vel`, 'success');
                return true;
            } else {
                log(`âŒ FunÃ§Ã£o ${functionName} NÃƒO encontrada`, 'error');
                return false;
            }
        }
        
        function testResetFunction() {
            log('ğŸ§ª Testando funÃ§Ã£o resetAllNumbers...');
            
            if (checkFunction('resetAllNumbers')) {
                updateStatus('resetStatus', 'âœ… FunÃ§Ã£o resetAllNumbers disponÃ­vel', 'success');
                
                const testReset = confirm('âš ï¸ ATENÃ‡ÃƒO: Deseja realmente testar a funÃ§Ã£o de reset?\n\nIsso pode apagar dados reais se houver algum!\n\nRecomendo testar apenas com dados de teste.');
                
                if (testReset) {
                    log('ğŸš¨ UsuÃ¡rio confirmou teste de reset', 'warning');
                    try {
                        window.resetAllNumbers();
                        log('âœ… FunÃ§Ã£o resetAllNumbers executada', 'success');
                    } catch (error) {
                        log(`âŒ Erro ao executar resetAllNumbers: ${error.message}`, 'error');
                    }
                } else {
                    log('â„¹ï¸ Teste de reset cancelado pelo usuÃ¡rio', 'info');
                }
            } else {
                updateStatus('resetStatus', 'âŒ FunÃ§Ã£o resetAllNumbers NÃƒO encontrada', 'error');
            }
        }
        
        function testExportFunction() {
            log('ğŸ§ª Testando funÃ§Ã£o exportParticipants...');
            
            if (checkFunction('exportParticipants')) {
                updateStatus('exportStatus', 'âœ… FunÃ§Ã£o exportParticipants disponÃ­vel', 'success');
                
                try {
                    window.exportParticipants();
                    log('âœ… FunÃ§Ã£o exportParticipants executada', 'success');
                } catch (error) {
                    log(`âŒ Erro ao executar exportParticipants: ${error.message}`, 'error');
                }
            } else {
                updateStatus('exportStatus', 'âŒ FunÃ§Ã£o exportParticipants NÃƒO encontrada', 'error');
            }
        }
        
        function testDrawFunction() {
            log('ğŸ§ª Testando funÃ§Ã£o performDraw...');
            
            if (checkFunction('performDraw')) {
                updateStatus('drawStatus', 'âœ… FunÃ§Ã£o performDraw disponÃ­vel', 'success');
                
                const testDraw = confirm('ğŸ² Deseja testar a funÃ§Ã£o de sorteio?\n\nSe houver dados reais, um sorteio real serÃ¡ realizado!');
                
                if (testDraw) {
                    log('ğŸ² UsuÃ¡rio confirmou teste de sorteio', 'info');
                    try {
                        window.performDraw();
                        log('âœ… FunÃ§Ã£o performDraw executada', 'success');
                    } catch (error) {
                        log(`âŒ Erro ao executar performDraw: ${error.message}`, 'error');
                    }
                } else {
                    log('â„¹ï¸ Teste de sorteio cancelado pelo usuÃ¡rio', 'info');
                }
            } else {
                updateStatus('drawStatus', 'âŒ FunÃ§Ã£o performDraw NÃƒO encontrada', 'error');
            }
        }
        
        function testDeleteFunction() {
            log('ğŸ§ª Testando funÃ§Ã£o deleteParticipant...');
            
            if (checkFunction('deleteParticipant')) {
                updateStatus('deleteStatus', 'âœ… FunÃ§Ã£o deleteParticipant disponÃ­vel', 'success');
                log('â„¹ï¸ FunÃ§Ã£o deleteParticipant encontrada (usada pelos botÃµes de aÃ§Ã£o)', 'info');
            } else {
                updateStatus('deleteStatus', 'âŒ FunÃ§Ã£o deleteParticipant NÃƒO encontrada', 'error');
            }
        }
        
        function createTestData() {
            log('ğŸ§ª Tentando criar dados de teste...');
            
            if (checkFunction('createSampleData')) {
                try {
                    window.createSampleData();
                    log('âœ… Dados de teste criados', 'success');
                } catch (error) {
                    log(`âŒ Erro ao criar dados de teste: ${error.message}`, 'error');
                }
            } else {
                log('âš ï¸ FunÃ§Ã£o createSampleData nÃ£o encontrada', 'warning');
            }
        }
        
        function openAdmin() {
            window.open('admin.html', '_blank');
            log('ğŸ”§ Painel admin aberto', 'info');
        }
        
        function openMainPage() {
            window.open('index.html', '_blank');
            log('ğŸ  PÃ¡gina principal aberta', 'info');
        }
        
        function clearLog() {
            document.getElementById('logArea').innerHTML = '=== LOG LIMPO ===';
        }
        
        // VerificaÃ§Ã£o inicial
        function init() {
            log('ğŸ”§ Iniciando verificaÃ§Ã£o das funÃ§Ãµes de aÃ§Ãµes rÃ¡pidas...');
            
            // Verificar todas as funÃ§Ãµes
            const functions = ['resetAllNumbers', 'exportParticipants', 'performDraw', 'deleteParticipant'];
            let allFound = true;
            
            functions.forEach(funcName => {
                if (!checkFunction(funcName)) {
                    allFound = false;
                }
            });
            
            if (allFound) {
                updateStatus('connectionStatus', 'âœ… Todas as funÃ§Ãµes estÃ£o disponÃ­veis!', 'success');
                log('ğŸ‰ Todas as funÃ§Ãµes de aÃ§Ãµes rÃ¡pidas estÃ£o implementadas', 'success');
            } else {
                updateStatus('connectionStatus', 'âš ï¸ Algumas funÃ§Ãµes estÃ£o faltando', 'warning');
                log('âš ï¸ Nem todas as funÃ§Ãµes estÃ£o disponÃ­veis', 'warning');
            }
            
            // Verificar status individual
            setTimeout(() => {
                testResetFunction();
                testExportFunction();
                testDrawFunction();
                testDeleteFunction();
            }, 1000);
        }
        
        // Iniciar quando carregar
        window.addEventListener('load', () => {
            setTimeout(init, 500);
        });
    </script>
</body>
</html>
