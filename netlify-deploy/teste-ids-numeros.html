<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste R√°pido - IDs dos N√∫meros</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 5px;
            margin: 20px 0;
        }
        .number-card {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: bold;
            font-size: 14px;
            border: 2px solid transparent;
            cursor: pointer;
        }
        .number-card.available {
            background: #ff6b35;
            color: white;
            border-color: #ff6b35;
        }
        .number-card.sold {
            background: #64748b;
            color: white;
            border-color: #64748b;
            opacity: 0.8;
        }
        .number-card.reserved {
            background: #f59e0b;
            color: white;
            border-color: #f59e0b;
        }
        .number-card.selected {
            background: #ffd700;
            color: #1a237e;
            border-color: #ffd700;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .status-info {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .status-box {
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .status-available {
            background: #ff6b35;
            color: white;
        }
        .status-sold {
            background: #64748b;
            color: white;
        }
        .status-reserved {
            background: #f59e0b;
            color: white;
        }
        .status-selected {
            background: #ffd700;
            color: #1a237e;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            background: #007bff;
            color: white;
        }
        button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Teste R√°pido - Verifica√ß√£o de IDs e Status dos N√∫meros</h1>
        <p><strong>Objetivo:</strong> Verificar se os n√∫meros t√™m IDs corretos e se os status s√£o aplicados adequadamente.</p>
        
        <div class="status-info">
            <div class="status-box status-available">
                <h3>DISPON√çVEL</h3>
                <p>Cor laranja (#ff6b35)</p>
            </div>
            <div class="status-box status-sold">
                <h3>VENDIDO</h3>
                <p>Cor cinza (#64748b)</p>
            </div>
            <div class="status-box status-reserved">
                <h3>RESERVADO</h3>
                <p>Cor amarelo (#f59e0b)</p>
            </div>
            <div class="status-box status-selected">
                <h3>SELECIONADO</h3>
                <p>Cor dourado (#ffd700)</p>
            </div>
        </div>
    </div>

    <div class="container">
        <h3>üéØ A√ß√µes de Teste</h3>
        <button onclick="testIDsExist()">üîç Verificar IDs dos N√∫meros</button>
        <button onclick="testStatusClasses()">üé® Testar Classes de Status</button>
        <button onclick="simulateMainPageBehavior()">üì± Simular Comportamento da P√°gina Principal</button>
        <button onclick="testDebugFunction()">üîß Testar Fun√ß√£o Debug</button>
        <button onclick="clearAllTests()">üóëÔ∏è Limpar Testes</button>
    </div>

    <div class="container">
        <h3>üé≤ Grade de Teste (N√∫meros 1-20)</h3>
        <div class="test-grid" id="test-grid">
            <!-- N√∫meros ser√£o gerados via JavaScript -->
        </div>
    </div>

    <div class="container">
        <h3>üìä Resultados</h3>
        <div class="log" id="log"></div>
    </div>

    <script>
        // Configura√ß√µes similares √† p√°gina principal
        const RIFA_CONFIG = {
            totalNumbers: 150,
            ticketPrice: 40.00
        };

        let rifaState = {
            selectedNumbers: new Set(),
            soldNumbers: new Set(),
            reservedNumbers: new Set()
        };

        function log(message, type = 'info') {
            const logEl = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            logEl.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logEl.scrollTop = logEl.scrollHeight;
        }

        // Fun√ß√£o id√™ntica √† da p√°gina principal
        function createNumberCard(number) {
            const card = document.createElement('div');
            card.className = 'number-card';
            card.id = `number-${number}`; // Esta linha √© crucial - verifica se est√° sendo aplicada
            card.textContent = number.toString().padStart(3, '0');
            card.dataset.number = number;
            
            updateNumberStatus(card, number);
            
            card.addEventListener('click', function() {
                if (!rifaState.soldNumbers.has(number) && !rifaState.reservedNumbers.has(number)) {
                    toggleNumberSelection(number);
                }
            });
            
            return card;
        }

        // Fun√ß√£o id√™ntica √† da p√°gina principal
        function updateNumberStatus(card, number) {
            card.classList.remove('available', 'selected', 'sold', 'reserved');
            
            if (rifaState.soldNumbers.has(number)) {
                card.classList.add('sold');
            } else if (rifaState.reservedNumbers.has(number)) {
                card.classList.add('reserved');
            } else if (rifaState.selectedNumbers.has(number)) {
                card.classList.add('selected');
            } else {
                card.classList.add('available');
            }
        }

        function toggleNumberSelection(number) {
            if (rifaState.selectedNumbers.has(number)) {
                rifaState.selectedNumbers.delete(number);
            } else {
                rifaState.selectedNumbers.add(number);
            }
            
            updateNumberDisplay(number);
        }

        function updateNumberDisplay(number) {
            const card = document.getElementById(`number-${number}`);
            if (card) {
                updateNumberStatus(card, number);
                log(`N√∫mero ${number} atualizado com sucesso`, 'success');
            } else {
                log(`ERRO: Elemento com ID number-${number} N√ÉO ENCONTRADO!`, 'error');
            }
        }

        // Fun√ß√£o simulando a updateNumbersDisplay da p√°gina principal
        function updateNumbersDisplay() {
            log('Iniciando atualiza√ß√£o de n√∫meros (simulando p√°gina principal)...', 'info');
            
            try {
                for (let i = 1; i <= 20; i++) { // Teste com os primeiros 20 n√∫meros
                    const element = document.getElementById(`number-${i}`);
                    if (!element) {
                        log(`PROBLEMA: Elemento number-${i} n√£o encontrado!`, 'error');
                        continue;
                    }
                    
                    // Remover todas as classes de status
                    element.classList.remove('sold', 'selected', 'reserved', 'available');
                    
                    // Aplicar classe apropriada baseada no estado
                    if (rifaState.soldNumbers.has(i)) {
                        element.classList.add('sold');
                    } else if (rifaState.reservedNumbers.has(i)) {
                        element.classList.add('reserved');
                    } else if (rifaState.selectedNumbers.has(i)) {
                        element.classList.add('selected');
                    } else {
                        element.classList.add('available');
                    }
                }
                
                log('‚úÖ Atualiza√ß√£o de n√∫meros conclu√≠da com sucesso', 'success');
            } catch (error) {
                log(`‚ùå Erro na atualiza√ß√£o: ${error.message}`, 'error');
            }
        }

        // Gerar grade de teste
        function generateTestGrid() {
            const grid = document.getElementById('test-grid');
            grid.innerHTML = '';
            
            log('Gerando grade de teste...', 'info');
            
            for (let i = 1; i <= 20; i++) {
                const numberCard = createNumberCard(i);
                grid.appendChild(numberCard);
            }
            
            log('Grade de teste gerada com 20 n√∫meros', 'success');
        }

        // Testes
        function testIDsExist() {
            log('üîç TESTE: Verificando se todos os IDs existem...', 'info');
            
            let idsEncontrados = 0;
            let idsNaoEncontrados = [];
            
            for (let i = 1; i <= 20; i++) {
                const element = document.getElementById(`number-${i}`);
                if (element) {
                    idsEncontrados++;
                } else {
                    idsNaoEncontrados.push(i);
                }
            }
            
            if (idsNaoEncontrados.length === 0) {
                log(`‚úÖ SUCESSO: Todos os 20 IDs foram encontrados!`, 'success');
            } else {
                log(`‚ùå PROBLEMA: ${idsNaoEncontrados.length} IDs n√£o encontrados: ${idsNaoEncontrados.join(', ')}`, 'error');
            }
            
            log(`üìä Resultado: ${idsEncontrados}/20 IDs encontrados`, 'info');
        }

        function testStatusClasses() {
            log('üé® TESTE: Verificando aplica√ß√£o de classes de status...', 'info');
            
            // Definir alguns n√∫meros com status espec√≠ficos
            rifaState.soldNumbers = new Set([1, 5, 10]);
            rifaState.reservedNumbers = new Set([2, 6, 11]);
            rifaState.selectedNumbers = new Set([3, 7, 12]);
            
            // Aplicar atualiza√ß√µes
            updateNumbersDisplay();
            
            // Verificar se as classes foram aplicadas corretamente
            let sucessos = 0;
            let problemas = [];
            
            // Verificar vendidos
            [1, 5, 10].forEach(num => {
                const el = document.getElementById(`number-${num}`);
                if (el && el.classList.contains('sold')) {
                    sucessos++;
                } else {
                    problemas.push(`N√∫mero ${num} deveria estar 'sold'`);
                }
            });
            
            // Verificar reservados
            [2, 6, 11].forEach(num => {
                const el = document.getElementById(`number-${num}`);
                if (el && el.classList.contains('reserved')) {
                    sucessos++;
                } else {
                    problemas.push(`N√∫mero ${num} deveria estar 'reserved'`);
                }
            });
            
            // Verificar selecionados
            [3, 7, 12].forEach(num => {
                const el = document.getElementById(`number-${num}`);
                if (el && el.classList.contains('selected')) {
                    sucessos++;
                } else {
                    problemas.push(`N√∫mero ${num} deveria estar 'selected'`);
                }
            });
            
            if (problemas.length === 0) {
                log(`‚úÖ SUCESSO: Todas as classes de status aplicadas corretamente!`, 'success');
            } else {
                log(`‚ùå PROBLEMAS encontrados:`, 'error');
                problemas.forEach(p => log(`  - ${p}`, 'error'));
            }
            
            log(`üìä Resultado: ${sucessos}/9 status aplicados corretamente`, 'info');
        }

        function simulateMainPageBehavior() {
            log('üì± TESTE: Simulando comportamento da p√°gina principal...', 'info');
            
            // Simular dados salvos no localStorage
            const testRifaData = {
                soldNumbers: [4, 8, 15],
                reservedNumbers: [9, 16, 20],
                lastUpdate: new Date().toISOString()
            };
            
            localStorage.setItem('rifaData', JSON.stringify(testRifaData));
            log('Dados salvos no localStorage', 'info');
            
            // Simular carregamento dos dados (como na p√°gina principal)
            const savedData = localStorage.getItem('rifaData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    rifaState.soldNumbers = new Set(data.soldNumbers || []);
                    rifaState.reservedNumbers = new Set(data.reservedNumbers || []);
                    rifaState.selectedNumbers = new Set(); // Limpar sele√ß√µes
                    
                    log('Dados carregados do localStorage', 'success');
                    log(`Vendidos: ${data.soldNumbers.join(', ')}`, 'info');
                    log(`Reservados: ${data.reservedNumbers.join(', ')}`, 'info');
                    
                    // Atualizar exibi√ß√£o
                    updateNumbersDisplay();
                    
                } catch (error) {
                    log(`Erro ao carregar dados: ${error.message}`, 'error');
                }
            }
        }

        function testDebugFunction() {
            log('üîß TESTE: Testando fun√ß√£o debug...', 'info');
            
            // Fun√ß√£o debug similar √† da p√°gina principal
            function debugRifaNumbers() {
                log('üîß Debug: Recarregando n√∫meros da rifa...', 'info');
                
                // Log do estado atual
                log('üìä Estado atual da rifa:', 'info');
                log(`- N√∫meros vendidos: [${Array.from(rifaState.soldNumbers).join(', ')}]`, 'info');
                log(`- N√∫meros reservados: [${Array.from(rifaState.reservedNumbers).join(', ')}]`, 'info');
                log(`- N√∫meros selecionados: [${Array.from(rifaState.selectedNumbers).join(', ')}]`, 'info');
                
                // Verificar IDs
                let idsOk = 0;
                for (let i = 1; i <= 20; i++) {
                    const element = document.getElementById(`number-${i}`);
                    if (element) idsOk++;
                }
                
                log(`üîç Verifica√ß√£o de IDs: ${idsOk}/20 elementos encontrados`, idsOk === 20 ? 'success' : 'error');
                
                // Atualizar exibi√ß√£o
                updateNumbersDisplay();
                
                log('üîß Debug conclu√≠do', 'success');
            }
            
            debugRifaNumbers();
        }

        function clearAllTests() {
            log('üóëÔ∏è Limpando todos os testes...', 'info');
            
            // Limpar estado
            rifaState.soldNumbers.clear();
            rifaState.reservedNumbers.clear();
            rifaState.selectedNumbers.clear();
            
            // Limpar localStorage
            localStorage.removeItem('rifaData');
            
            // Regenerar grade
            generateTestGrid();
            
            log('‚úÖ Testes limpos, estado resetado', 'success');
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Teste de IDs e Status iniciado', 'info');
            generateTestGrid();
            
            // Executar teste inicial autom√°tico
            setTimeout(() => {
                log('‚ö° Executando teste autom√°tico inicial...', 'info');
                testIDsExist();
            }, 1000);
        });
    </script>
</body>
</html>
